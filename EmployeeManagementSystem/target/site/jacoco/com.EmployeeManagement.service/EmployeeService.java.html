<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>EmployeeService.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">EmployeeManagementSystem</a> &gt; <a href="index.source.html" class="el_package">com.EmployeeManagement.service</a> &gt; <span class="el_source">EmployeeService.java</span></div><h1>EmployeeService.java</h1><pre class="source lang-java linenums">package com.EmployeeManagement.service;

import com.EmployeeManagement.exceptions.NoDataFoundException;
import com.EmployeeManagement.model.Employee;
import com.EmployeeManagement.model.ResponseData;
import com.EmployeeManagement.repository.DepartmentRepository;
import com.EmployeeManagement.repository.EmployeeRepository;
import org.hibernate.annotations.common.util.impl.LoggerFactory;
import org.jboss.logging.Logger;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.stereotype.Service;

import java.util.*;

@Service
<span class="nc" id="L18">public class EmployeeService {</span>
<span class="nc" id="L19">    Logger logger = LoggerFactory.logger(EmployeeService.class);</span>

    @Autowired
    private EmployeeRepository employeeRepository;
    private DepartmentRepository departmentRepository;
    private DepartmentService departmentService;

<span class="nc" id="L26">    ResponseData result = new ResponseData();</span>

    public void responseData() {
<span class="nc" id="L29">        result.setMessage(&quot;Failed&quot;);</span>
<span class="nc" id="L30">        result.setEmployeeList(null);</span>
<span class="nc" id="L31">        result.setEmployeeDataBasedOnDepartment(null);</span>
<span class="nc" id="L32">        result.setDepartmentList(null);</span>
<span class="nc" id="L33">    }</span>

    // Count Total Number of employee
    public ResponseEntity&lt;ResponseData&gt; employeeStrength() {
<span class="nc" id="L37">        logger.info(&quot;Total Count&quot;);</span>

<span class="nc" id="L39">            result.setMessage(&quot;Total No: of Staff: &quot; + employeeRepository.count());</span>
<span class="nc" id="L40">            return new ResponseEntity&lt;ResponseData&gt;(result, HttpStatus.FOUND);</span>

    }

    public ResponseEntity&lt;ResponseData&gt; getAllEmployeeDetails() {
        try {
<span class="nc" id="L46">            logger.info(&quot;Fetch All Employee Data&quot;);</span>
<span class="nc" id="L47">            List&lt;Employee&gt; employeeList = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L48">            employeeRepository.findAll().forEach(employeeList::add);</span>
<span class="nc bnc" id="L49" title="All 2 branches missed.">            if (employeeList.isEmpty()) {</span>
<span class="nc" id="L50">                result.setMessage(&quot;No Data Found. Employee details are not added yet&quot;);</span>
<span class="nc" id="L51">                return new ResponseEntity&lt;ResponseData&gt;(result, HttpStatus.NO_CONTENT);</span>
            } else {
<span class="nc" id="L53">                result.setMessage(&quot;Data Found&quot;);</span>
<span class="nc" id="L54">                result.setEmployeeList(employeeList);</span>
<span class="nc" id="L55">                return new ResponseEntity&lt;ResponseData&gt;(result, HttpStatus.OK);</span>
            }
<span class="nc" id="L57">        } catch (Exception e) {</span>
<span class="nc" id="L58">            responseData();</span>
<span class="nc" id="L59">            return new ResponseEntity&lt;ResponseData&gt;(result, HttpStatus.BAD_REQUEST);</span>
        }
    }

    // Get employee data based on ID

    public ResponseEntity&lt;ResponseData&gt; getAllEmployeeByID(int Id) {
<span class="nc" id="L66">        List&lt;Employee&gt; employeeListByID = new ArrayList&lt;&gt;();</span>
        try {
<span class="nc" id="L68">            logger.info(&quot;Get employee data based on ID&quot;);</span>
<span class="nc" id="L69">            Optional&lt;Employee&gt; resultData = employeeRepository.findById(Id);</span>
<span class="nc bnc" id="L70" title="All 2 branches missed.">            if (resultData.isPresent()) {</span>
<span class="nc" id="L71">                employeeListByID.add(resultData.get());</span>
<span class="nc" id="L72">                result.setEmployeeList(employeeListByID);</span>
            }
<span class="nc bnc" id="L74" title="All 2 branches missed.">            if (employeeListByID.isEmpty()) {</span>
<span class="nc" id="L75">                responseData();</span>
<span class="nc" id="L76">                result.setMessage(&quot;No Data Found&quot;);</span>
<span class="nc" id="L77">                return new ResponseEntity&lt;ResponseData&gt;(result, HttpStatus.NOT_FOUND);</span>
            } else {
<span class="nc" id="L79">                result.setMessage(&quot;Searched ID is found&quot;);</span>
<span class="nc" id="L80">                return new ResponseEntity&lt;ResponseData&gt;(result, HttpStatus.OK);</span>
            }
<span class="nc" id="L82">        } catch (Exception e) {</span>
<span class="nc" id="L83">            responseData();</span>
<span class="nc" id="L84">            return new ResponseEntity&lt;ResponseData&gt;(result, HttpStatus.BAD_REQUEST);</span>
        }

    }


    // Get employee data by Number
    public ResponseEntity&lt;ResponseData&gt; getEmployeeByNumber(String Number) {
<span class="nc" id="L92">        logger.info(&quot;Get employee data by Name&quot;);</span>
        try {
<span class="nc" id="L94">            List&lt;Employee&gt; fetchEmployeeByNumber = employeeRepository.findByEmployeeNumber(Number);</span>
<span class="nc bnc" id="L95" title="All 2 branches missed.">            if (fetchEmployeeByNumber.size() == 0) {</span>
<span class="nc" id="L96">                responseData();</span>
<span class="nc" id="L97">                result.setMessage(&quot;Searched Employee is not found&quot;);</span>
<span class="nc" id="L98">                return new ResponseEntity&lt;ResponseData&gt;(result, HttpStatus.NOT_FOUND);</span>
            } else {
<span class="nc" id="L100">                result.setEmployeeList(fetchEmployeeByNumber);</span>
<span class="nc" id="L101">                result.setMessage(&quot;Searched Employee is found&quot;);</span>
<span class="nc" id="L102">                return new ResponseEntity&lt;ResponseData&gt;(result, HttpStatus.FOUND);</span>
            }
<span class="nc" id="L104">        } catch (Exception e) {</span>
<span class="nc" id="L105">            responseData();</span>
<span class="nc" id="L106">            return new ResponseEntity&lt;ResponseData&gt;(result, HttpStatus.BAD_REQUEST);</span>
        }

    }


    // Get employee data by Name
    public ResponseEntity&lt;ResponseData&gt; getEmployeeByName(String name) {
<span class="nc" id="L114">        logger.info(&quot;Get employee data by Name&quot;);</span>
        try {
<span class="nc" id="L116">            List&lt;Employee&gt; fetchEmployeeByName = employeeRepository.findByName(name);</span>
<span class="nc bnc" id="L117" title="All 2 branches missed.">            if (fetchEmployeeByName.size() == 0) {</span>
<span class="nc" id="L118">                responseData();</span>
<span class="nc" id="L119">                result.setMessage(&quot;Searched Employee is not found&quot;);</span>
<span class="nc" id="L120">                return new ResponseEntity&lt;ResponseData&gt;(result, HttpStatus.NOT_FOUND);</span>
            } else {
<span class="nc" id="L122">                result.setEmployeeList(fetchEmployeeByName);</span>
<span class="nc" id="L123">                result.setMessage(&quot;Searched Employee is found&quot;);</span>
<span class="nc" id="L124">                return new ResponseEntity&lt;ResponseData&gt;(result, HttpStatus.FOUND);</span>
            }
<span class="nc" id="L126">        } catch (Exception e) {</span>
<span class="nc" id="L127">            responseData();</span>
<span class="nc" id="L128">            return new ResponseEntity&lt;ResponseData&gt;(result, HttpStatus.BAD_REQUEST);</span>
        }

    }

    // Add Multiple employee Details
    /*public ResponseEntity&lt;ResponseData&gt; addEmployeeBatch(Employee employee) {
        logger.info(&quot; Add Multiple employee Details&quot;);
        try {
            Employee e1 = new Employee(1, &quot;EMP123&quot;, &quot;Jhon&quot;, &quot;17/03/1993&quot;,
                    &quot;Male&quot;, &quot;jhon@gmail.com&quot;, &quot;0431440140&quot;, &quot;MCA&quot;, 3,
                    &quot;23/12/2020&quot;, &quot;Melbourne&quot;, &quot;Victoria&quot;, new Department(5,&quot;Testing&quot;));
            Employee e2 = new Employee(2, &quot;EMP128&quot;, &quot;Meera&quot;, &quot;17/03/1993&quot;, &quot;Male&quot;, &quot;meera@gmail.com&quot;,
                    &quot;0431440140&quot;, &quot;MCA&quot;, 3, &quot;23/12/2020&quot;, &quot;Melbourne&quot;, &quot;Victoria&quot;, new Department(5,&quot;Testing&quot;));

            Employee e3 = new Employee(3, &quot;EMP130&quot;, &quot;Meera&quot;, &quot;17/03/1993&quot;, &quot;Male&quot;, &quot;meera@gmail.com&quot;,
                    &quot;0431440140&quot;, &quot;MCA&quot;, 3, &quot;23/12/2020&quot;, &quot;Melbourne&quot;, &quot;Victoria&quot;, new Department(3,&quot;Designing&quot;));

            List&lt;Employee&gt; employeeList = Arrays.asList(e1, e2, e3, e3);
            employeeRepository.saveAll(employeeList);
            employeeList.add(employee);
            result.setEmployeeList(employeeList);
            result.setMessage(&quot;Employee data added successfully.&quot;);
            return new ResponseEntity&lt;ResponseData&gt;(result, HttpStatus.CREATED);
        }catch (Exception e) {
            result.setMessage(&quot;Failed&quot;);
            return new ResponseEntity&lt;ResponseData&gt;(result, HttpStatus.BAD_REQUEST);
        }
    }*/

    // Add new employee to the table
    public ResponseEntity&lt;ResponseData&gt; addEmployee(Employee employee) {
<span class="nc" id="L160">        logger.info(&quot; Add new employee&quot;);</span>
<span class="nc" id="L161">        List&lt;Employee&gt; employeeList = new ArrayList&lt;&gt;();</span>
        try {
            String empNum, email;
            int deptID;
<span class="nc" id="L165">            empNum = employee.getEmployeeNumber();</span>
<span class="nc" id="L166">            deptID = employee.getDepartment().getDEPARTMENTID();</span>
<span class="nc" id="L167">            email = employee.getEmailID();</span>
            // int fetchEmail = employeeRepository.findEmailExists(empNum,email);

//            if(fetchEmail==1){
//                result.setMessage(&quot;EmailID Exists&quot;);
//                return new ResponseEntity&lt;ResponseData&gt;(result, HttpStatus.NOT_ACCEPTABLE);
//            }
<span class="nc" id="L174">            int departmentExists = employeeRepository.findAnyDepartment(deptID);</span>
<span class="nc bnc" id="L175" title="All 2 branches missed.">            if (departmentExists == 0) {</span>
<span class="nc" id="L176">                responseData();</span>
<span class="nc" id="L177">                result.setMessage(&quot;Department Not Exists&quot;);</span>
<span class="nc" id="L178">                return new ResponseEntity&lt;ResponseData&gt;(result, HttpStatus.FORBIDDEN);</span>
            }
<span class="nc" id="L180">            int employeeNumberWithDepartment = employeeRepository.findEmployeeNumberAndDepartment(deptID, empNum);</span>

<span class="nc bnc" id="L182" title="All 2 branches missed.">            if (employeeNumberWithDepartment == 0) {</span>

<span class="nc" id="L184">                employeeRepository.save(employee);</span>
<span class="nc" id="L185">                employeeList.add(employee);</span>
<span class="nc" id="L186">                result.setEmployeeList(employeeList);</span>
<span class="nc" id="L187">                result.setMessage(&quot;Employee added successfully.&quot;);</span>
<span class="nc" id="L188">                return new ResponseEntity&lt;ResponseData&gt;(result, HttpStatus.CREATED);</span>
            } else {
<span class="nc" id="L190">                responseData();</span>
<span class="nc" id="L191">                result.setMessage(&quot;Sorry. This employee is already added to the department\n.&quot;);</span>
<span class="nc" id="L192">                return new ResponseEntity&lt;ResponseData&gt;(result, HttpStatus.FORBIDDEN);</span>
            }

<span class="nc" id="L195">        } catch (Exception e) {</span>
<span class="nc" id="L196">            responseData();</span>
<span class="nc" id="L197">            return new ResponseEntity&lt;ResponseData&gt;(result, HttpStatus.BAD_REQUEST);</span>
        }
    }

    // Delete employee based on ID
    public ResponseEntity&lt;ResponseData&gt; removeEmployee(int id) {

<span class="nc" id="L204">        logger.info(&quot;Delete an Employee by ID- Service&quot;);</span>
        try {
<span class="nc bnc" id="L206" title="All 2 branches missed.">            if (employeeRepository.existsById(id)) {</span>
<span class="nc" id="L207">                employeeRepository.deleteById(id);</span>
<span class="nc" id="L208">                responseData();</span>
<span class="nc" id="L209">                result.setMessage(&quot;Employee Id &quot; + id + &quot; has been deleted&quot;);</span>
<span class="nc" id="L210">                return new ResponseEntity&lt;ResponseData&gt;(result, HttpStatus.OK);</span>
            } else {
<span class="nc" id="L212">                throw new NoDataFoundException();</span>
            }

<span class="nc" id="L215">        } catch (Exception e) {</span>
<span class="nc" id="L216">            responseData();</span>
<span class="nc" id="L217">            result.setMessage(&quot;The id is invalid for the employee.&quot;);</span>
<span class="nc" id="L218">            return new ResponseEntity&lt;ResponseData&gt;(result, HttpStatus.NOT_FOUND);</span>
        }
    }

    // Delete employees based on the Ids' in the list
    public ResponseEntity&lt;ResponseData&gt; deleteEmployeeList(List&lt;Integer&gt; employeeIDList) {
<span class="nc" id="L224">        logger.info(&quot;Delete employee based on a list &quot;);</span>

        try {
<span class="nc bnc" id="L227" title="All 2 branches missed.">            if (employeeIDList.size() &gt;= 1) {</span>
<span class="nc bnc" id="L228" title="All 2 branches missed.">                if (employeeRepository.findAllById(employeeIDList) != null) {</span>
<span class="nc" id="L229">                    employeeRepository.deleteAllById(employeeIDList);</span>
<span class="nc" id="L230">                    responseData();</span>
<span class="nc" id="L231">                    result.setMessage(&quot;Mentioned Employee Ids' are deleted successfully&quot;);</span>
<span class="nc" id="L232">                    return new ResponseEntity&lt;ResponseData&gt;(result, HttpStatus.OK);</span>
                }
            }
<span class="nc" id="L235">            result.setMessage(&quot;The List is empty&quot;);</span>
<span class="nc" id="L236">            return new ResponseEntity&lt;ResponseData&gt;(result, HttpStatus.NO_CONTENT);</span>
<span class="nc" id="L237">        } catch (Exception e) {</span>
<span class="nc" id="L238">            responseData();</span>
<span class="nc" id="L239">            result.setMessage(&quot;Failed. One of the employee IDs' is not in the DB&quot;);</span>
<span class="nc" id="L240">            return new ResponseEntity&lt;ResponseData&gt;(result, HttpStatus.BAD_REQUEST);</span>
        }
    }

    // Delete all employee from the database
    public ResponseEntity&lt;ResponseData&gt; deleteAllEmployeeData() {
<span class="nc" id="L246">        logger.info(&quot; Delete all employee from the database &quot;);</span>
        try {
<span class="nc" id="L248">            long count = employeeRepository.count();</span>
<span class="nc bnc" id="L249" title="All 2 branches missed.">            if (count &gt;= 1) {</span>
<span class="nc" id="L250">                employeeRepository.deleteAll();</span>
<span class="nc" id="L251">                responseData();</span>
<span class="nc" id="L252">                result.setMessage(&quot;All Details are deleted.&quot;);</span>
<span class="nc" id="L253">                return new ResponseEntity&lt;ResponseData&gt;(result, HttpStatus.OK);</span>
            } else {
<span class="nc" id="L255">                responseData();</span>
<span class="nc" id="L256">                result.setMessage(&quot;Table is Empty&quot;);</span>
<span class="nc" id="L257">                return new ResponseEntity&lt;ResponseData&gt;(result, HttpStatus.BAD_REQUEST);</span>
            }

<span class="nc" id="L260">        } catch (Exception e) {</span>
<span class="nc" id="L261">            responseData();</span>
<span class="nc" id="L262">            return new ResponseEntity&lt;ResponseData&gt;(result, HttpStatus.BAD_REQUEST);</span>
        }
    }

}

</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>